<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>NAS | Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">

<style>
body{font-family:'Cairo',sans-serif}
.card3d{transition:.4s}
.card3d:hover{transform:scale(1.02)}
.toast{
 position:fixed;top:10px;left:50%;
 transform:translateX(-50%);
 background:#111;color:#fff;
 padding:10px 20px;border-radius:10px;
 z-index:9999
}
</style>
</head>

<body class="bg-gradient-to-br from-gray-900 to-black text-white min-h-screen p-4">

<h1 class="text-3xl font-bold text-center mb-4">NAS - Ù†Ø¸Ø§Ù… Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª</h1>

<div id="toast" class="hidden toast"></div>

<!-- Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª -->
<div class="flex justify-center gap-4 mb-4">
  <div id="paidCount"></div>
  <div id="expiredCount"></div>
</div>

<!-- ÙÙˆØ±Ù… -->
<div class="max-w-md mx-auto bg-gray-800 p-4 rounded-xl shadow-xl card3d">
  <input id="name" placeholder="Ø§Ø³Ù… Ø§Ù„Ø²Ø¨ÙˆÙ†" class="input">
  <input id="phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ø²Ø¨ÙˆÙ†" class="input">
  <input id="service" placeholder="Ù†ÙˆØ¹ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ (Ù…Ø«Ø§Ù„: Canva Pro)" class="input">
  <input id="username" placeholder="ÙŠÙˆØ²Ø± (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)" class="input">
  <input id="link" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„Ø²Ø¨ÙˆÙ†" class="input">

  <div class="grid grid-cols-3 gap-2 my-3">
    <button onclick="setDays(7)">Ø£Ø³Ø¨ÙˆØ¹ÙŠ</button>
    <button onclick="setDays(30)">Ø´Ù‡Ø±ÙŠ</button>
    <button onclick="setDays(90)">3 Ø£Ø´Ù‡Ø±</button>
    <button onclick="setDays(180)">6 Ø£Ø´Ù‡Ø±</button>
    <button onclick="setDays(365)" class="col-span-3">Ø³Ù†ÙˆÙŠ</button>
  </div>

  <div class="flex gap-2">
    <button onclick="setPaid(true)" class="flex-1 bg-green-600 py-2 rounded">Ù…Ø¯ÙÙˆØ¹</button>
    <button onclick="setPaid(false)" class="flex-1 bg-red-600 py-2 rounded">ØºÙŠØ± Ù…Ø¯ÙÙˆØ¹</button>
  </div>

  <button onclick="saveClient()" class="w-full bg-white text-black mt-3 py-2 rounded font-bold">
    Ø­ÙØ¸ Ø§Ù„Ø²Ø¨ÙˆÙ†
  </button>
</div>

<!-- Ø§Ù„Ø¨Ø­Ø« -->
<div class="max-w-md mx-auto mt-4">
  <input id="search" oninput="render()" placeholder="ğŸ” Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ù„Ø±Ù‚Ù… Ø£Ùˆ Ø§Ù„Ø±Ø§Ø¨Ø·"
   class="w-full p-2 rounded text-black">
</div>

<!-- Ù‚Ø§Ø¦Ù…Ø© -->
<div class="max-w-md mx-auto mt-4" id="clients"></div>

<!-- Ø¨Ø·Ø§Ù‚Ø© -->
<div id="card" class="hidden fixed inset-0 bg-black/80 flex items-center justify-center p-4">
  <div id="cardContent" class="bg-white text-black p-4 rounded-xl w-full max-w-sm">
    <h2 class="text-xl font-bold text-center">NAS</h2>
    <div id="cardInfo"></div>
    <hr class="my-2">
    <p>ğŸ“ 07726744162</p>
    <p>ğŸ“· <a href="https://www.instagram.com/l11nl?igsh=YnF0bTU4MXAyamZ3">@l11nl</a></p>
    <div class="flex gap-2 mt-3">
      <button onclick="saveImage()" class="flex-1 bg-green-600 text-white py-2 rounded">Ø­ÙØ¸</button>
      <button onclick="shareImage()" class="flex-1 bg-blue-600 text-white py-2 rounded">Ù…Ø´Ø§Ø±ÙƒØ©</button>
      <button onclick="closeCard()" class="flex-1 bg-gray-500 text-white py-2 rounded">Ø¥ØºÙ„Ø§Ù‚</button>
    </div>
  </div>
</div>

<script>
let days=0, paid=false, editIndex=null;
let clients=JSON.parse(localStorage.getItem("clients")||"[]");

function toast(msg){
 const t=document.getElementById("toast");
 t.textContent=msg; t.classList.remove("hidden");
 setTimeout(()=>t.classList.add("hidden"),4000);
}

function setDays(d){days=d}
function setPaid(p){paid=p}

function saveClient(){
 const start=new Date();
 const end=new Date(start); end.setDate(end.getDate()+days);

 const data={
  name:name.value, phone:phone.value,
  service:service.value,
  user:username.value, link:link.value,
  paid, start:start.toISOString(), end:end.toISOString()
 };

 if(editIndex!==null){clients[editIndex]=data; editIndex=null;}
 else clients.push(data);

 localStorage.setItem("clients",JSON.stringify(clients));
 render();
}

function render(){
 const q=(search.value||"").toLowerCase();
 const list=document.getElementById("clients");
 list.innerHTML="";
 let paidC=0, expC=0;
 const now=new Date();

 clients.forEach((c,i)=>{
  const end=new Date(c.end);
  const diff=(end-now)/(1000*60*60*24);
  if(c.paid) paidC++;
  if(diff<0) expC++;
  if(diff<0) toast(`âš ï¸ Ø§Ø´ØªØ±Ø§Ùƒ Ù…Ù†ØªÙ‡ÙŠ: ${c.name}`);
  else if(diff<=3) toast(`â° Ù‚Ø±Ø¨ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ø´ØªØ±Ø§Ùƒ: ${c.name}`);

  if(
   c.name.toLowerCase().includes(q)||
   c.phone.includes(q)||
   c.link.toLowerCase().includes(q)
  ){
   list.innerHTML+=`
   <div class="bg-gray-800 p-3 rounded mb-2 card3d">
    <div onclick="openCard(${i})" class="cursor-pointer">
     ${diff<0?"â­":""} ğŸ‘¤ ${c.name} - ${c.service}
    </div>
    <div class="flex gap-2 mt-2">
     <button onclick="edit(${i})">âœï¸</button>
     <button onclick="del(${i})">ğŸ—‘ï¸</button>
    </div>
   </div>`;
  }
 });

 paidCount.textContent=`âœ… Ù…Ø¯ÙÙˆØ¹: ${paidC}`;
 expiredCount.textContent=`â­ Ù…Ù†ØªÙ‡ÙŠ: ${expC}`;
}

function edit(i){
 const c=clients[i];
 name.value=c.name; phone.value=c.phone;
 service.value=c.service;
 username.value=c.user; link.value=c.link;
 paid=c.paid; editIndex=i;
}

function del(i){
 if(confirm("Ø­Ø°Ù Ø§Ù„Ø²Ø¨ÙˆÙ†ØŸ")){
  clients.splice(i,1);
  localStorage.setItem("clients",JSON.stringify(clients));
  render();
 }
}

function openCard(i){
 const c=clients[i];
 cardInfo.innerHTML=`
 <p>ğŸ‘¤ ${c.name}</p>
 <p>ğŸ“± ${c.phone}</p>
 <p>ğŸ’¼ ${c.service}</p>
 <p>ğŸ”— ${c.link}</p>
 <p>${c.paid?"âœ… Ù…Ø¯ÙÙˆØ¹":"âŒ ØºÙŠØ± Ù…Ø¯ÙÙˆØ¹"}</p>
 <p>ğŸ“… ${new Date(c.start).toLocaleDateString("ar")}</p>
 <p>â³ ${new Date(c.end).toLocaleDateString("ar")}</p>`;
 card.classList.remove("hidden");
}

function closeCard(){card.classList.add("hidden")}

function saveImage(){
 html2canvas(cardContent).then(c=>{
  const a=document.createElement("a");
  a.href=c.toDataURL(); a.download="NAS.png"; a.click();
 });
}

function shareImage(){
 html2canvas(cardContent).then(c=>{
  c.toBlob(b=>{
   navigator.share({
    files:[new File([b],"NAS.png",{type:"image/png"})],
    title:"NAS",
    text:"ØªÙØ§ØµÙŠÙ„ Ø§Ø´ØªØ±Ø§ÙƒÙƒ"
   });
  });
 });
}

render();
</script>

<style>
.input{
 width:100%;margin-bottom:8px;
 padding:8px;border-radius:8px;color:black
}
button{background:#444;padding:4px 8px;border-radius:6px}
</style>

</body>
</html>
